
[Simplified Chinese](README.md) | English

- [Capstone Design Project](#capstone-design-project)
  - [1.Project Introduction](#1project-introduction)
    - [1.1 Project Overview](#11-project-overview)
    - [1.2 Hardware Used](#12-hardware-used)
    - [1.3 Hardware Wiring Diagram](#13-hardware-wiring-diagram)
  - [2.Code Usage Instructions](#2code-usage-instructions)
    - [2.1 Preparations Before Use](#21-preparations-before-use)
    - [2.2 How to Use the Code](#22-how-to-use-the-code)

 # Capstone Design Project
## 1.Project Introduction
### 1.1 Project Overview
This project reads weight data from a remote weighing scale and allows users to record the current data as tare weight, gross weight or net weight by **keyborad control** . The three sets of data can be saved in an excel spreadsheet automatically generated by the program after it ends.
### 1.2 Hardware Used 
The weighing scale used is [xk3190](xk3190.pdf)
<br>The remote communication module (unknown name) using RS485 DB9 communication above.
<br>USB to E-type (9-pin) DB9 standard interface.

### 1.3 Hardware Wiring Diagram 
**Computer end:** use USB to E-type (9-pin) DB9 standard interface, insert USB port, baud rate is set at **9600**, directly receive byte string data.
<br>**xk3190 end:** Connect +IN and +OUT with15-core wires **short-circuit** into **RS485 A** end of communication module, and -IN,-OUT **short-circuit** into **RS48 B** end of communication module. Finally, connect GND to make the module share ground with the weighing scale.

## 2.Code Usage Instructions
### 2.1 Preparations Before Use 
After completing the wiring connection, please modify the port number in line 65 of the code as shown below:
```python
ser = serial.Serial("COM10", 9600) # Open COM10 and configure baud rate as115200. Other parameters use default values.
```
Change COM10 to your computer's port number such as COM1 or COM2 after modifying it.
### 2.2 How to Use the Code
After modifying the port number, run the code directly. The output area will print data in this format:
```python
Current weight,tare weight,gross weight,net weight
```
Then perform button operations according to requirements.The button operations are shown below:
```python
a-Record current weight as tare weight.
b-Record current weight as gross weight.
s-Save current data to excel spreadsheet.
Esc-Exit program.
```
###23.Saved Excel Spreadsheet 
The name of excel is
<br> **2023-05-26_22_34_02_Data Record.xlsx**
<br>Where2023-05-26_22_34_02is time (year-month-day,hour-minute-second) when program runs,and Data Record is a fixed string for recording data .
<br>The table is automatically saved inthe same directory.

##3.Precautions 
This code is a simple course design project with low quality and only serves as reference material.
<br>If you have any questions,welcome to contact me by email or bilibili private message.
<br>Email:
<br>1469259223@qq.com 
<br>scnuyyj@gmail.com
<br>Bilibili:
<br>[这里是啊J](https://space.bilibili.com/23620249?spm_id_from=333.1007.0.0)